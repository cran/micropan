%% $Id: fluidity.Rd 185 2014-09-03 08:09:01Z larssn $

\name{fluidity}
\alias{fluidity}

\title{
  Computing genomic fluidity for a pan-genome
}
\description{
  Computes the genomic fluidity, which is a measure of population diversity.
}
\usage{
fluidity(pan.matrix,n.sim=10)
}
\arguments{
  \item{pan.matrix}{A \code{Panmat} object, see \code{\link{panMatrix}} for details.}
  \item{n.sim}{An integer specifying the number of random samples to use in the computations.}
}
\details{
  The genomic fluidity between two genomes is defined as the number of unique gene families divided by the total number of gene families (Kislyuk et al, 2011). This is averaged over \samp{n.sim} random pairs of genomes to obtain a population estimate.

  The genomic fluidity between two genomes describes their degree of overlap with respect to gene cluster content. If the fluidity is 0.0, the two genomes contain identical gene clusters. If it is 1.0 the two genomes are non-overlapping. The difference between a Jaccard distance (see \code{\link{distJaccard}}) and genomic fluidity is small, they both measure overlap between genomes, but fluidity is computed for the population by averaging over many pairs, while Jaccard distances are computed for every pair. Note that only presence/absence of gene clusters are considered, not multiple occurrences.
  
  The input \samp{pan.matrix} is typically constructed by \code{\link{panMatrix}}.
}
\value{
  A list with two elements, the mean fluidity and its sample standard deviation over the \samp{n.sim} computed values.
}
\references{
  Kislyuk, A.O., Haegeman, B., Bergman, N.H., Weitz, J.S. (2011). Genomic fluidity: an integrative view of gene diversity within microbial populations. BMC Genomics, 12:32.
}
\author{
  Lars Snipen and Kristian Hovde Liland.
}

\seealso{
  \code{\link{panMatrix}}, \code{\link{distJaccard}}.
}
\examples{
# Loading two Panmat objects in the micropan package
data(list=c("Mpneumoniae.blast.panmat","Mpneumoniae.domain.panmat"),package="micropan")

# Fluidity based on a BLAST clustering Panmat object
fluid.blast <- fluidity(Mpneumoniae.blast.panmat)

# Fluidity based on domain sequence clustering Panmat object
fluid.domains <- fluidity(Mpneumoniae.domain.panmat)
}
